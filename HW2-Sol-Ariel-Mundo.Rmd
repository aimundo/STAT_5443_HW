---
title: STAT 5443, HW2
author: Ariel Mundo
date: 9/15/2020
output:
    #df_print: paged
  prettydoc::html_pretty:
    theme: cayman
    #highlight: github
---


```{r setup, include=FALSE}
#knitr::opts_chunk$set(echo = TRUE)
library(prettydoc)
```

#### PROBLEM 1

##### PART A

Since $p(x)=\sin(x)$ the $CDF$ is calculated as:

\[\int_0^{x} \sin w~dw\] which yields:
\[F(x)=1-\cos(x)\] 
and using the inverse CDF Transform:

\[u=1-\cos(F^{-1}(u))\] 
\[F^{-1}(u)=\arccos(1-u)\]


```{r, PROBLEM 1}

set.seed(123)
u<-runif(n=10000)
x<-acos(1-u)
y<-seq(from=0,to=pi/2,0.01)
f<-sin(y)
hist(x,freq = F)
lines(y,f,col="red")
```
##### PART B: REJECTION SAMPLING METHOD
```{r}

#http://www.ericfrazerlock.com/Rejection_Sampling_Rcode1.r
#http://ericfrazerlock.com/Rejection_Sampling.pdf
#https://datasciencechalktalk.com/2019/09/22/understanding-rejection-sampling-method/
rejection <- function(f, M, g, rg,n) {
  naccepts <- 0
  result.sample <- rep(NA, n)

  while (naccepts < n) {
    y <- rg(1)
    u <- runif(1)

    if ( u <= f(y) / (M*g )) {
      naccepts <- naccepts + 1
      result.sample[naccepts] = y
    }
  }

  result.sample
}

f <- function(x) sin(x)
#g <- function(x) 1
g <- runif(1)
rg <- runif
M <- 1.5 #upper bound on f (via basic calculus)

result <- rejection(f, M, g,rg, 10000)

print(length(result[result <= 0.8])/10000)
hist(result,freq=FALSE)
lines(y,sin(y),type="l")

```
***



#### PROBLEM 2

$p(x)=\lambda x^{-\lambda -1}$ therefore:
\[\int_1^{x} w^{-\lambda -1}~dw\] which yields:
\[F(x)=1-x^{-\lambda}\]
Using the inversion method:
\[F^{-1}=\sqrt[-\lambda]{u-1}\]

```{r, PROBLEM 2}
lambda<-4
lambda_fun<-function(lambda,n=1){
u<-runif(n)
#x=-exp(log(u)/-lambda)
x<-1/((1-u)^(1/lambda))
return(x)
}
y=seq(1,6,0.2)
fy=(lambda*y^(-lambda-1))
hist(lambda_fun(lambda,100),freq=F)
lines(y,fy,col="red")
```
