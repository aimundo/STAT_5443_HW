---
title: STAT 5443, HW2
author: Ariel Mundo
date: 9/15/2020
output:
    #df_print: paged
  prettydoc::html_pretty:
    theme: cayman
    #highlight: github
---


```{r setup, include=FALSE}
#knitr::opts_chunk$set(echo = TRUE)
library(prettydoc)
```

#### PROBLEM 1

##### PART A

Since $p(x)=\sin(x)$ the $CDF$ is calculated as:

\[\int_0^{x} \sin w~dw\] which yields:
\[F(x)=1-\cos(x)\] 
and using the inverse CDF Transform:

\[u=1-\cos(F^{-1}(u))\] 
\[F^{-1}(u)=\arccos(1-u)\]


```{r, PROBLEM 1}

set.seed(123)
u<-runif(n=10000)
x<-acos(1-u)
y<-seq(from=0,to=pi/2,0.01)
f<-sin(y)
hist(x,freq = F)
lines(y,f,col="red")
```
##### PART B: REJECTION SAMPLING METHOD
```{r}
M<-2 #scaling
n<-10000 #number of iterations
final_sample<-rep(NA,n)
accept<-0
while (accept<n){
    y<-runif(1,0,pi/2) #get one random number between 0 and pi/2 as the value to input in f(x)
    u<-runif(1,0,1)  #another random number between 0 and 1 to compare
    if (M*u<=sin(y)){  #if the value of M*u is less or equal than the target distribution, then
        
        accept<-accept+1 #if the value falls under the desired pdf, increase the counter by 1
        final_sample[accept]<-y #store the random number that was evaluated in f(x)  
        
    }
}
p<-seq(from=0,to=pi/2,0.01)
w<-sin(p)

hist(final_sample,freq=F)
lines(p,w,col="red")

```


***



#### PROBLEM 2

$p(x)=\lambda x^{-\lambda -1}$ therefore:
\[\int_1^{x} w^{-\lambda -1}~dw\] which yields:
\[F(x)=1-x^{-\lambda}\]
Using the inversion method:
\[F^{-1}=\frac{1}{\sqrt[\lambda]{1-u}}\]

```{r, PROBLEM 2}
lambda<-4
lambda_fun<-function(lambda,n=1){
u<-runif(n)
#x=-exp(log(u)/-lambda)
x<-1/((1-u)^(1/lambda))
return(x)
}
y=seq(1,6,0.2)
fy=(lambda*y^(-lambda-1))
hist(lambda_fun(lambda,100),freq=F)
lines(y,fy,col="red")
```

#### PROBLEM 3

Function is $f(x)\propto\exp (-x^{4}/12)$
Plotting the function:
```{r, PROBLEM 3}
curve(exp(-(x^4)/12),0,2)
```
STEP 1
under the transformation $x=y^{1/n}$, where $dx=\frac{1}{n}y^{\frac{1}{n}-1} dy$, and substituting accordingly, the transformed density becomes:
\[f(y)=\frac{1}{n}\int_0^{\infty}{\rm e}^{-ky}{y}^{\frac{1}{n}-1}dy\]
Comparing with the density of Gamma, $\alpha=\frac{1}{n}$ and $\lambda=k$

```{r}


````
